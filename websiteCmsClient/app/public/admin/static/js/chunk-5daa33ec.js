(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5daa33ec"],{"0c93":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g-content"},[e.pageLoading?r("Loading"):r("div",[r("Form",{ref:"infoForm",attrs:{model:e.infoForm,rules:e.validate,"label-width":100}},[r("Form-item",{attrs:{label:"文章标题：",prop:"title"}},[r("Input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.infoForm.title,callback:function(t){e.$set(e.infoForm,"title",t)},expression:"infoForm.title"}})],1),r("Form-item",{attrs:{label:"文章封面：",prop:"imgUrl"}},[r("ImageCropper",{attrs:{src:e.infoForm.imgUrl,"upload-dir":"img/article/",preview:!0,fixed:!0,fixedNumber:[90,59],autoCropWidth:450,fileSize:300,"size-hint":"450*295px"},on:{"get-img-url":e.setPoster}})],1),r("Form-item",{attrs:{label:"作者："}},[r("Input",{attrs:{placeholder:"请输入作者名称"},model:{value:e.infoForm.author,callback:function(t){e.$set(e.infoForm,"author",t)},expression:"infoForm.author"}})],1),r("Form-item",{attrs:{label:"文章摘要："}},[r("Input",{attrs:{type:"textarea",rows:3,maxlength:50,placeholder:"请输入文章摘要(不超过50个字符)"},model:{value:e.infoForm.summary,callback:function(t){e.$set(e.infoForm,"summary",t)},expression:"infoForm.summary"}})],1),r("Form-item",{attrs:{label:"关键词："}},[e._l(e.infoForm.metaKeywords,(function(t,o){return r("Tag",{key:o,attrs:{name:t,closable:""},on:{"on-close":function(t){return e.removeKeyword(o)}}},[e._v(e._s(t))])})),r("Button",{attrs:{icon:"ios-add",type:"dashed",size:"small"},on:{click:function(t){return e.kwModelVisible(!0)}}},[e._v("添加关键词")])],2),r("Form-item",{attrs:{label:"页面描述："}},[r("Input",{attrs:{type:"textarea",rows:3,maxlength:200,placeholder:"请输入文章描述（不超过200个字符）"},model:{value:e.infoForm.metaDescription,callback:function(t){e.$set(e.infoForm,"metaDescription",t)},expression:"infoForm.metaDescription"}})],1),r("Form-item",{attrs:{label:"文章内容：",prop:"content"}},[r("Tinymce",{attrs:{placeholder:"请输入文章内容",height:"500"},model:{value:e.infoForm.content,callback:function(t){e.$set(e.infoForm,"content",t)},expression:"infoForm.content"}})],1),r("div",{staticClass:"m-operation"},["edit"==e.pageType?r("Button",{staticClass:"fr",attrs:{type:"primary"},on:{click:function(t){return e.submit("infoForm")}}},[e._v("确认修改")]):r("Button",{staticClass:"fr",attrs:{type:"primary"},on:{click:function(t){return e.submit("infoForm")}}},[e._v("确认新增")]),r("Button",{staticClass:"fr",attrs:{type:"default"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),r("div",{staticClass:"clearfix"})],1)],1)],1),r("Modal",{attrs:{width:600,title:"添加关键词"},on:{"on-cancel":function(t){return e.kwModelVisible(!1)}},model:{value:e.kwModelShow,callback:function(t){e.kwModelShow=t},expression:"kwModelShow"}},[r("div",[r("Form",{ref:"kwModelForm",attrs:{model:e.kwModelForm,rules:e.validate,"label-width":80}},[r("Form-item",{attrs:{label:"关键词：",prop:"keyword"}},[r("Input",{attrs:{type:"textarea",placeholder:"请输入关键词"},model:{value:e.kwModelForm.keyword,callback:function(t){e.$set(e.kwModelForm,"keyword",t)},expression:"kwModelForm.keyword"}})],1),r("div",{staticClass:"hint"},[e._v('* 输入的关键词请以逗号" , "进行分隔')])],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"text"},on:{click:function(t){return e.kwModelVisible(!1)}}},[e._v("取消")]),r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.addKeywords("kwModelForm")}}},[e._v("确认")])],1)])],1)},n=[],i=r("be51"),a=r("e634"),c=r("557c"),s=r("ed08"),l=r("b4b9"),u=r("19bc"),m={components:{Loading:i["a"],ImageCropper:a["a"],Tinymce:c["a"]},mixins:[l["a"]],data:function(){return{pageLoading:!0,pageType:"add",articleId:"",infoForm:{imgUrl:"",title:"",author:"",metaKeywords:[],metaDescription:"",summary:"",content:""},validate:{title:[{required:!0,message:"文章标题不能为空",trigger:"blur"}],content:[{required:!0,message:"文章内容不能为空",trigger:"blur"}],imgUrl:[{required:!0,validator:function(e,t,r){return r()}}],keyword:[{required:!0,message:"关键词不能为空",trigger:"blur"}]}}},created:function(){var e=Object(s["l"])("id");e?(this.articleId=e,this.$store.commit("common/SET_BREADCRUMB",[{name:"新闻资讯",path:"/admin/ArticleManage/List"},{name:"文章详情",path:""}]),this.getDetail(),this.pageType="edit"):(this.pageLoading=!1,this.$store.commit("common/SET_BREADCRUMB",[{name:"新闻资讯",path:"/admin/ArticleManage/List"},{name:"新增文章",path:""}]))},methods:{submit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){if(""==t.infoForm.imgUrl)return t.$Message.error("请上传文章封面"),!1;t.pageLoading=!0,t.infoForm.metaKeywords=Object(s["c"])(t.infoForm.metaKeywords,","),"add"==t.pageType?u["a"].AddArticle(t.infoForm).then((function(e){t.pageLoading=!1,200==e.code?t.$Message.success({content:"新增成功",onClose:function(){t.$router.push({name:"ArticleManage"})}}):t.$Message.warning(e.msg)})).catch((function(e){return t.$Message.error(e.message)})):u["a"].EditArticle(t.infoForm,t.articleId).then((function(e){t.pageLoading=!1,200==e.code?(t.$Message.success("修改成功"),t.getDetail()):t.$Message.warning(e.msg)})).catch((function(e){return console.log(e)}))}else t.$Message.error("提交失败！填写有误")}))},getDetail:function(){var e=this;u["a"].GetDetail(this.articleId).then((function(t){e.pageLoading=!1,200==t.code?(e.infoForm=t.data,e.infoForm.metaKeywords=t.data.metaKeywords?Object(s["v"])(t.data.metaKeywords,","):[]):e.$Message.warning(t.msg)})).catch((function(e){return console.log(e)}))},setPoster:function(e){this.infoForm.imgUrl=e}}},d=m,f=(r("daee"),r("2877")),p=Object(f["a"])(d,o,n,!1,null,"26be7a8d",null);t["default"]=p.exports},"19bc":function(e,t,r){"use strict";r("d3b7");var o=r("b775");t["a"]={GetList:function(e){return new Promise((function(t,r){o["a"].HttpGet("/api/WebsiteCms/ArticleService/News/GetList",e).then((function(e){return t(e)})).catch((function(e){return r(e)}))}))},AddArticle:function(e){return new Promise((function(t,r){o["a"].HttpPost("/api/WebsiteCms/ArticleService/News/AddArticle",e).then((function(e){return t(e)})).catch((function(e){return r(e)}))}))},DelArticle:function(e){return new Promise((function(t,r){o["a"].HttpPost("/api/WebsiteCms/ArticleService/News/DelArticle",e).then((function(e){return t(e)})).catch((function(e){return r(e)}))}))},SetEnable:function(e,t){return new Promise((function(r,n){o["a"].HttpPost("/api/WebsiteCms/ArticleService/News/SetEnable?enable=".concat(e),t).then((function(e){return r(e)})).catch((function(e){return n(e)}))}))},SetShowIndex:function(e,t){return new Promise((function(r,n){o["a"].HttpPost("/api/WebsiteCms/ArticleService/News/SetShowIndex?isHome=".concat(e),t).then((function(e){return r(e)})).catch((function(e){return n(e)}))}))},GetDetail:function(e){return new Promise((function(t,r){o["a"].HttpGet("/api/WebsiteCms/ArticleService/News/GetDetail?id=".concat(e)).then((function(e){return t(e)})).catch((function(e){return r(e)}))}))},EditArticle:function(e,t){return new Promise((function(r,n){o["a"].HttpPost("/api/WebsiteCms/ArticleService/News/EditArticle?id=".concat(t),e).then((function(e){return r(e)})).catch((function(e){return n(e)}))}))}}},"1bb3":function(e,t,r){},a630:function(e,t,r){var o=r("23e7"),n=r("4df4"),i=r("1c7e"),a=!i((function(e){Array.from(e)}));o({target:"Array",stat:!0,forced:a},{from:n})},b4b9:function(e,t,r){"use strict";r("a434"),r("ac1f"),r("5319");function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function n(e){if(Array.isArray(e))return o(e)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function i(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}r("fb6a"),r("b0c0"),r("25f0");function a(e,t){if(e){if("string"===typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e){return n(e)||i(e)||a(e)||c()}var l=r("ed08");t["a"]={data:function(){return{kwModelShow:!1,kwModelForm:{keyword:""}}},methods:{kwModelVisible:function(e){this.kwModelShow=e,e||(this.kwModelForm.keyword="")},removeKeyword:function(e){this.infoForm.metaKeywords.splice(e,1)},addKeywords:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var r=t.kwModelForm.keyword.replace(/\s*/g,"");r=r.replace(/，/g,",");var o=Object(l["v"])(r,",");o=Object(l["b"])(o);var n=t.infoForm.metaKeywords;n.push.apply(n,s(o)),t.infoForm.metaKeywords=Object(l["x"])(n),t.kwModelVisible(!1)}else t.$Message.error("提交失败！填写有误")}))}}}},daee:function(e,t,r){"use strict";var o=r("1bb3"),n=r.n(o);n.a},fb6a:function(e,t,r){"use strict";var o=r("23e7"),n=r("861d"),i=r("e8b5"),a=r("23cb"),c=r("50c4"),s=r("fc6a"),l=r("8418"),u=r("b622"),m=r("1dde"),d=r("ae40"),f=m("slice"),p=d("slice",{ACCESSORS:!0,0:0,1:2}),h=u("species"),b=[].slice,g=Math.max;o({target:"Array",proto:!0,forced:!f||!p},{slice:function(e,t){var r,o,u,m=s(this),d=c(m.length),f=a(e,d),p=a(void 0===t?d:t,d);if(i(m)&&(r=m.constructor,"function"!=typeof r||r!==Array&&!i(r.prototype)?n(r)&&(r=r[h],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return b.call(m,f,p);for(o=new(void 0===r?Array:r)(g(p-f,0)),u=0;f<p;f++,u++)f in m&&l(o,u,m[f]);return o.length=u,o}})}}]);